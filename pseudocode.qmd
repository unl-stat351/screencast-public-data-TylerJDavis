---
url---
title: "psuedocode"
author: "Tyler Davis"
format: html
editor: visual
---

```{r}

library(rvest)
library(httr2)
library(tidyverse)

#write a fuction to analyze a team data pitching and batting only!


html <- read_html("https://www.baseball-reference.com/teams/CHC/index.shtml")

tables <- html %>%
  html_table()


cubs <- data.frame(tables[[1]])

worse_year <- cubs %>%
  filter( W.L. == min(W.L.))
best_year <- cubs %>%
  filter(W.L. >= .700)


worse_years_recent <- cubs %>%
  filter(Year > 1950) %>%
  filter(W.L. <= .400)


best_years_recent <- cubs %>%
  filter(Year > 1950) %>%
  filter(W.L. >=  .600)

summary(cubs$W.L.)
hist(cubs$W.L.)

cubs$winning_catagory <- cut(cubs$W.L.,breaks = c(0,.4,.5,.6,1),labels = c("0-.4 Winning Percentage",".4-.5 Winning Percentage", ".5-.6 Winning Percentage",".6 and above Winning Percentage"))



cubs$playoffs_app <- ifelse(grepl("\\S", cubs$Playoffs),1,0)


seasons_winning <- cubs %>%
  group_by(winning_catagory) %>%
  summarise(counts = n(),play_count = sum(playoffs_app))

NL_east <- cubs %>%
  filter(Lg == "NL East")

NL_central <- cubs %>%
  filter(Lg == "NL Central")


```

```{r}

library(rvest)
library(httr2)
library(tidyverse)

#write a fuction to analyze a team 


mlb_codes_table <- read_html("https://www.baseball-reference.com/about/team_IDs.shtml") %>%
  html_table
mlb_codes <- mlb_codes_table[[1]]
new_colnames <- mlb_codes[1,]
colnames(mlb_codes) <- new_colnames

mlb_codes_key <- mlb_codes[-1,-1]



#putting it into a function
team_info <- function(Team_code,year,stat,season){
  url <- paste("https://www.baseball-reference.com/teams/",Team_code,"/",year,".shtml", sep= "")

  team_dat_1 <- read_html(url) %>%
  html_table()
  
  if(length(team_dat_1) == 4){
  
  if(stat == "Hitting" && season == "Regular"){
    data <- data.frame(team_dat_1[[1]])
    return(data)
  } else if(stat == "Hitting" && season == "Playoff"){
    data <- data.frame(team_dat_1[[2]])
    return(data)
  } else if(stat == "Pitching" && season == "Regular"){
    data <- data.frame(team_dat_1[[3]])
    return(data)
  } else if(stat == "Pitching" && season == "Playoff"){
    data <- data.frame(team_dat_1[[4]])
    return(data)
  }
    
  } else if(length(team_dat_1) == 2){
   if(season == "Playoff"){
     return("Your Team did not make the playoffs this year")
   } else if(stat == "Hitting"){
     data <- data.frame(team_dat_1[[1]])
     return(data)
   }else if(stat == "Pitching"){
     data <- data.frame(team_dat_1[[2]])
     return(data)
   }
  } else{
    return("You did not put your input in the right format. All inputs to this function must be string variables")
  }
}  
  
data <- team_info("CHC","2016","Hitting","Regular")


```

```{r}

library(readr)
sta_dat <- read_csv("Major_League_Baseball_Stadiums_(with_Placekey).csv")



team_stadium <- function(team){
library(leaflet)
library(tidyverse)
library(mlbplotR)
team_info <- load_mlb_teams() %>%
  filter(team_name == team) %>%
  select(team_color,team_logo_espn)

color <- team_info$team_color
logo <- team_info$team_logo_espn



sta_dat %>%
  filter(TEAM == team) %>%
  leaflet() %>%
  addTiles %>%
  addCircleMarkers(
    lat = ~LATITUDE,
    lng = ~LONGITUDE,
    color = color,
    fillColor = color,
    fillOpacity = .8,
    popup = ~paste0(
      '<img src="',logo,'" style="width:150px;height:auto;">',"<br>",
      "Stadium: ",NAME,"<br>",
      "Capacity: ", CAPACITY)
  )


}


team_stadium("Arizona Diamondbacks")

```
